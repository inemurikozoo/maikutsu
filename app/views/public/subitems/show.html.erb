<script>


  window.addEventListener('DOMContentLoaded', function(){

    //今の在庫の値を取得
    var input_inventory = document.getElementById("now_inventory");

    //いまの在庫の数字が変わったときに、updateを実行する
    input_inventory.addEventListener("change",function(){
      $.ajax(
        url: 'subitems/:id',
        type: "PATCH"
        );
    })



  })
</script>


  <div class="container-fluid">
  <h1 class="mt-3 text-center bg-success border border-secondary">こもの詳細/編集</h1>

  <div class="row">
    <div class="col-md-2">
      <%= render 'layouts/genre_side_menu', categories: @categories %>
    </div>
    <div class="col-md-10">
      <div class="row">
        <div class="col-md-6">
          <div class="mono_image">
            <img src="" alt="" class="rounded" size="75x75">
          </div>
          <h2 class="mt-3 text-center bg-light border border-secondary box-shadow">
            <%= @sub_item.item.name %>
          </h2>
          <h5 class="mt-3 text-center bg-right border border-secondary">
            <%= @sub_item.item.category.name %>
          </h5>
            <div class="border border-secondary bg-info">
              <h4 class="font-weight-bold text-center">いまの在庫</h4>
              <div class="d-flex justify-content-center">
                <!--<%= link_to "－", url: subitem_minus_path, method: :patch, class:"btn btn-light" %>-->
                <h3><%= form_with model: @sub_item, url: update_subitem_path(@sub_item.id), local: true do |f| %></h3>
                <h3><%= f.text_field :inventory, style: "border: none", size: "1" ,id:"now_inventory"%></h3>
                <!--<%= link_to "＋", url: subitem_plus_path, method: :patch, class:"btn btn-light" %>-->
                <h3><%= @sub_item.unit %></h3>
                <%= f.submit "更新", class: "btn btn-sm btn-secondary" %>
                <% end %>
              </div>
            </div>
            <div class="border border-secondary bg-warning">
              <h4 class="font-weight-bold text-center">在庫アラート</h4>
              <div class="d-flex justify-content-center">
                <p>OFF </p>
                <div class="custom-control custom-switch">
                  <input class="custom-control-input" type="checkbox" id="alert_inventory" name="alert_inventory">
                  <label class="custom-control-label" for="alert_inventory"></label>
                </div>
                <p>ON</p>
              </div>
              <div class="d-flex justify-content-center">
              <h3><%= form_with model: @sub_item, url: update_subitem_path(@sub_item.id), local: true do |f| %></h3>
              <h3><%= f.text_field :inv_constant, style: "border: none", size: "1" %></h3>
              <h3><%= @sub_item.unit %></h3>
              <%= f.submit "更新", class: "btn btn-sm btn-secondary" %>
              <% end %>
              </div>
            </div>
            <div class="border border-secondary bg-danger">
              <h4 class="font-weight-bold text-center">使用期限アラート</h4>
              <div class="d-flex justify-content-center">
                <p>OFF </p>
                <div class="custom-control custom-switch">
                  <input class="custom-control-input" type="checkbox" id="alert_expiration" name="alert_expiration">
                  <label class="custom-control-label" for="alert_expiration"></label>
                </div>
                <p>ON</p>
              </div>
            <div class="d-flex justify-content-center">
              <h3><%= form_with model: @sub_item, url: update_subitem_path(@sub_item.id), local: true do |f| %></h3>
              <h3><%= f.date_field :expiration_days, style: "border: none", size: "1" %></h3>
              <h3></h3>
              <%= f.submit "更新", class: "btn btn-sm btn-secondary" %>
              <% end %>
            </div>
          </div>
          <div class="border border-secondary bg-light">
            <h4 class="font-weight-bold text-center">メモ</h4>
            <div class="d-flex justify-content-center">
              <div class=""></div>
              <h3><%= form_with model: @sub_item, url: update_subitem_path(@sub_item.id), local: true do |f| %></h3>
              <p><%= f.text_area :memo, style: "border: none", class: "ml-auto" %></h3>
              <h3></h3>
              <%= f.submit "更新", class: "btn btn-sm btn-secondary" %>
              <% end %>
            </div>
          </div>
          <%= link_to "削除する", url: destroy_subitem_path(@sub_item.id), class: "btn btn-sm btn-secondary" %>
        </div>
    </div>
  </div>
  <script>

  </script>
</div>
